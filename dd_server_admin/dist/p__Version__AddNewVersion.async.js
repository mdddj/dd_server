"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[14],{25874:function(K,O,e){e.d(O,{Z:function(){return D}});var Z=e(25465),o=e(83062),C=e(67294),l=e(97857),m=e.n(l),R=e(15009),v=e.n(R),T=e(99289),g=e.n(T),$=e(5574),M=e.n($),i=e(13769),p=e.n(i),E=e(20745),n=e(85893),x=function(u){return _jsx(Modal,_objectSpread({},u))};function A(h,u){var d=document.createElement("div");d.id="select-file";var t=(0,E.createRoot)(d),c=!0,s=C.cloneElement(h,m()(m()({open:c,getContainer:!1,onCancel:function(){var a=C.cloneElement(s,{open:!1});t.render(a),console.log("\u5173\u95ED"),setTimeout(function(){t.unmount(),d.remove()},300)}},u),{},{onFileSelect:function(a){u==null||u.onFileSelect(a);var y=C.cloneElement(s,{open:!1});t.render(y),setTimeout(function(){t.unmount(),d.remove()},300)}}));t.render(s),document.body.appendChild(d)}var W=e(9096),G=e(26859),z=e(55375),N=e(10981),H=e(44033),f=e(85576),w=e(11730),V=e(14726),_=e(89048),B=["onFileSelect"],J=function(u){var d=u.file,t=u.onClick;return(0,n.jsx)(H.J,{onClick:t,isZoomed:!0,alt:d.fileName,src:d.url,className:"object-contain w-full aspect-square bg-secondary-50"})},Q=function(u){var d=u.onFileSelect,t=p()(u,B),c=(0,C.useState)([]),s=M()(c,2),r=s[0],a=s[1],y=function(){var F=g()(v()().mark(function b(){var S;return v()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,(0,W.oC)({current:1,pageSize:20,remove:1});case 2:S=P.sent,a(S.data.list);case 4:case"end":return P.stop()}},b)}));return function(){return F.apply(this,arguments)}}();return(0,_.Z)(g()(v()().mark(function F(){return v()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,y();case 2:case"end":return S.stop()}},F)}))),(0,n.jsxs)(f.Z,m()(m()({title:"\u9009\u62E9\u6587\u4EF6"},t),{},{children:[(0,n.jsx)("div",{style:{marginBottom:12},children:(0,n.jsx)(w.Z,{name:"file",action:z.ty+"/api/storage/upload",headers:(0,N.P)(),onChange:function(){var F=g()(v()().mark(function b(S){return v()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(S.file.status!=="done"){P.next=3;break}return P.next=3,y();case 3:case"end":return P.stop()}},b)}));return function(b){return F.apply(this,arguments)}}(),children:(0,n.jsx)(V.ZP,{type:"primary",icon:(0,n.jsx)(G.Z,{}),children:"\u65B0."})})}),(0,n.jsx)("div",{className:"grid grid-cols-4 gap-2",children:r.map(function(F){return(0,n.jsx)(J,{file:F,onClick:function(){return d(F)}},F.id)})})]}))};function I(h){A((0,n.jsx)(Q,m()({},h)),h)}var j=function(u){var d,t;return(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("div",{style:{flex:1,marginRight:2},children:u.children}),(0,n.jsx)(o.Z,{title:"\u4ECE\u6587\u4EF6\u4E2D\u9009\u62E9\u56FE\u50CF",children:(0,n.jsx)(Z.Z,{style:{position:"absolute",top:(d=u.top)!==null&&d!==void 0?d:6,right:(t=u.right)!==null&&t!==void 0?t:12},onClick:function(){I(u)}})})]})},D=j},44067:function(K,O,e){e.r(O),e.d(O,{default:function(){return Q},findById:function(){return _}});var Z=e(49677),o=e.n(Z),C=e(15009),l=e.n(C),m=e(97857),R=e.n(m),v=e(99289),T=e.n(v),g=e(25874),$=e(14698);function M(I){var j=/^(https?):\/\/[-A-Za-z0-9+&@#\/%?=~_|!:,.;]*[-A-Za-z0-9+&@#\/%=~_|]$/;return j.test(I)}var i=e(90930),p=e(34994),E=e(64317),n=e(5966),x=e(90672),A=e(63434),W=e(50942),G=e(4393),z=e(67294),N=e(88580),H=e(89048),f=e(85893);function w(){return V.apply(this,arguments)}function V(){return V=T()(l()().mark(function I(){return l()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,W.request)("/api/project/all",{method:"GET"}));case 1:case"end":return D.stop()}},I)})),V.apply(this,arguments)}function _(I){return B.apply(this,arguments)}function B(){return B=T()(l()().mark(function I(j){return l()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,W.request)("/api/admin/version/get",{method:"GET",params:{id:j}}));case 1:case"end":return h.stop()}},I)})),B.apply(this,arguments)}var J=function(){var j=(0,z.useRef)(),D=(0,N.Z)("id"),h=function(){var t=T()(l()().mark(function c(s){var r;return l()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return console.log(s),y.next=3,(0,$.qx)(R()(R()({},s),{},{project:{id:s.projectId}}));case 3:return r=y.sent,y.abrupt("return",r.success);case 5:case"end":return y.stop()}},c)}));return function(s){return t.apply(this,arguments)}}();function u(){return d.apply(this,arguments)}function d(){return d=T()(l()().mark(function t(){var c,s,r,a,y,F,b,S,L;return l()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(!D){U.next=8;break}return c=parseInt(D),U.next=4,_(c);case 4:s=U.sent,r=s.success,a=s.data,r&&((y=j.current)===null||y===void 0||y.setFieldsValue(a),(F=j.current)===null||F===void 0||F.setFieldValue("projectId",(b=a.project)===null||b===void 0?void 0:b.id),(S=j.current)===null||S===void 0||S.setFieldValue("enable",(L=a.enable)!==null&&L!==void 0?L:!1));case 8:case"end":return U.stop()}},t)})),d.apply(this,arguments)}return(0,H.Z)(function(){D&&u()}),(0,f.jsx)(i._z,{title:"\u53D1\u5E03\u65B0\u7248\u672C",children:(0,f.jsx)(G.Z,{children:(0,f.jsxs)(p.A,{onFinish:h,formRef:j,children:[(0,f.jsx)(E.Z,{label:"\u5173\u8054\u9879\u76EE",name:"projectId",request:T()(l()().mark(function t(){var c;return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,w();case 2:return c=r.sent,r.abrupt("return",c.data.map(function(a){return{label:a.name,value:a.id}}));case 4:case"end":return r.stop()}},t)})),required:!0}),(0,f.jsx)(n.Z,{name:"id",label:"\u4E3B\u952E",hidden:!0}),(0,f.jsx)(n.Z,{name:"title",label:"\u6807\u9898"}),(0,f.jsx)(x.Z,{name:"description",label:"\u66F4\u65B0\u8BB0\u5F55",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u66F4\u65B0\u8BB0\u5F55"}]}),(0,f.jsx)(g.Z,{onFileSelect:function(c){var s,r,a;(s=j.current)===null||s===void 0||s.setFieldValue("downloadUrl",c.url),(r=j.current)===null||r===void 0||r.setFieldValue("packageSize",c.fileSize),(a=j.current)===null||a===void 0||a.setFieldValue("isDirectLink",!0)},children:(0,f.jsx)(x.Z,{fieldProps:{rows:5},name:"downloadUrl",label:"\u4E0B\u8F7D\u5730\u5740(\u76F4\u94FE)",rules:[function(t){return o()(t),{validator:function(s,r,a){r&&r.trim().length>0&&!M(r)?a("\u8BF7\u8F93\u5165\u6709\u6548\u7684\u4E0B\u8F7D\u5730\u5740"):a(void 0)}}}]})}),(0,f.jsx)(E.Z,{name:"platform",label:"\u5E73\u53F0",required:!0,options:[{label:"\u82F9\u679C",value:"Ios"},{label:"\u5B89\u5353",value:"Android"},{label:"Windows",value:"Windows"},{label:"Macos",value:"Macos"},{label:"Linux",value:"Linux"}]}),(0,f.jsx)(x.Z,{help:"\u591A\u4E2A\u8BF7\u6362\u884C",name:"htmlViewPage",label:"\u7B2C\u4E09\u65B9\u4E0B\u8F7D\u5730\u5740",rules:[function(t){return o()(t),{validator:function(s,r,a){r&&r.trim().length>0&&!M(r)?a("\u8BF7\u8F93\u5165\u6709\u6548\u7684\u4E0B\u8F7D\u5730\u5740"):a(void 0)}}}]}),(0,f.jsx)(n.Z,{name:"packageSize",label:"\u5305\u5927\u5C0F"}),(0,f.jsx)(A.Z,{name:"enable",label:"\u662F\u5426\u6709\u6548"}),(0,f.jsx)(A.Z,{name:"disabled",label:"\u662F\u5426\u6709\u6548",hidden:!0,initialValue:!0}),(0,f.jsx)(n.Z,{name:"versionNumber",label:"\u7248\u672C\u53F7",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7248\u672C\u53F7"}]})]})})})},Q=J},9096:function(K,O,e){e.d(O,{QU:function(){return $},Zq:function(){return T},oC:function(){return R}});var Z=e(15009),o=e.n(Z),C=e(99289),l=e.n(C),m=e(50942);function R(i){return v.apply(this,arguments)}function v(){return v=l()(o()().mark(function i(p){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/file/list",{params:p}));case 1:case"end":return n.stop()}},i)})),v.apply(this,arguments)}function T(i){return g.apply(this,arguments)}function g(){return g=l()(o()().mark(function i(p){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/storage/delete",{method:"DELETE",params:{id:p}}));case 1:case"end":return n.stop()}},i)})),g.apply(this,arguments)}function $(i){return M.apply(this,arguments)}function M(){return M=l()(o()().mark(function i(p){var E,n;return o()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return E=new FormData,E.append("file",p),A.next=4,(0,m.request)("/api/auth/simple-upload",{method:"POST",data:E});case 4:return n=A.sent,A.abrupt("return",n.data);case 6:case"end":return A.stop()}},i)})),M.apply(this,arguments)}},14698:function(K,O,e){e.d(O,{I9:function(){return $},qx:function(){return T}});var Z=e(15009),o=e.n(Z),C=e(99289),l=e.n(C),m=e(50942);function R(i){return v.apply(this,arguments)}function v(){return v=_asyncToGenerator(_regeneratorRuntime().mark(function i(p){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/version/list",{method:"GET",params:p}));case 1:case"end":return n.stop()}},i)})),v.apply(this,arguments)}function T(i){return g.apply(this,arguments)}function g(){return g=l()(o()().mark(function i(p){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/admin/version/save",{method:"POST",data:p}));case 1:case"end":return n.stop()}},i)})),g.apply(this,arguments)}function $(i){return M.apply(this,arguments)}function M(){return M=l()(o()().mark(function i(p){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/admin/version/delete",{method:"DELETE",params:{id:p}}));case 1:case"end":return n.stop()}},i)})),M.apply(this,arguments)}},10981:function(K,O,e){e.d(O,{P:function(){return o},V:function(){return C}});var Z=e(92273);function o(){var l,m=(l=(0,Z.rS)())!==null&&l!==void 0?l:"";return m!==""?{Authorization:m}:{}}function C(){return{"Content-Type":"multipart/form-data"}}}}]);
