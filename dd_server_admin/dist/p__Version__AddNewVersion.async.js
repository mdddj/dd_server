"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[14],{25874:function(W,Z,e){e.d(Z,{Z:function(){return D}});var I=e(25465),o=e(83062),C=e(67294),l=e(42122),m=e.n(l),$=e(17061),v=e.n($),T=e(17156),j=e.n(T),U=e(27424),M=e.n(U),i=e(70215),p=e.n(i),E=e(20745),n=e(85893),V=function(u){return _jsx(Modal,_objectSpread({},u))};function A(h,u){var d=document.createElement("div");d.id="select-file";var t=(0,E.createRoot)(d),c=!0,s=C.cloneElement(h,m()(m()({open:c,getContainer:!1,onCancel:function(){var a=C.cloneElement(s,{open:!1});t.render(a),console.log("\u5173\u95ED"),setTimeout(function(){t.unmount(),d.remove()},300)}},u),{},{onFileSelect:function(a){u==null||u.onFileSelect(a);var y=C.cloneElement(s,{open:!1});t.render(y),setTimeout(function(){t.unmount(),d.remove()},300)}}));t.render(s),document.body.appendChild(d)}var b=e(9096),z=e(88484),N=e(55375),H=e(10981),w=e(44033),f=e(85576),J=e(85303),B=e(28036),G=e(89048),L=["onFileSelect"],Q=function(u){var d=u.file,t=u.onClick;return(0,n.jsx)(w.J,{onClick:t,isZoomed:!0,alt:d.fileName,src:d.url,className:"object-contain w-full aspect-square bg-secondary-50"})},X=function(u){var d=u.onFileSelect,t=p()(u,L),c=(0,C.useState)([]),s=M()(c,2),r=s[0],a=s[1],y=function(){var F=j()(v()().mark(function O(){var S;return v()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,(0,b.oC)({current:1,pageSize:20,remove:1});case 2:S=P.sent,a(S.data.list);case 4:case"end":return P.stop()}},O)}));return function(){return F.apply(this,arguments)}}();return(0,G.Z)(j()(v()().mark(function F(){return v()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,y();case 2:case"end":return S.stop()}},F)}))),(0,n.jsxs)(f.Z,m()(m()({title:"\u9009\u62E9\u6587\u4EF6"},t),{},{children:[(0,n.jsx)("div",{style:{marginBottom:12},children:(0,n.jsx)(J.Z,{name:"file",action:N.ty+"/api/storage/upload",headers:(0,H.P)(),onChange:function(){var F=j()(v()().mark(function O(S){return v()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(S.file.status!=="done"){P.next=3;break}return P.next=3,y();case 3:case"end":return P.stop()}},O)}));return function(O){return F.apply(this,arguments)}}(),children:(0,n.jsx)(B.ZP,{type:"primary",icon:(0,n.jsx)(z.Z,{}),children:"\u65B0."})})}),(0,n.jsx)("div",{className:"grid grid-cols-4 gap-2",children:r.map(function(F){return(0,n.jsx)(Q,{file:F,onClick:function(){return d(F)}},F.id)})})]}))};function R(h){A((0,n.jsx)(X,m()({},h)),h)}var g=function(u){var d,t;return(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("div",{style:{flex:1,marginRight:2},children:u.children}),(0,n.jsx)(o.Z,{title:"\u4ECE\u6587\u4EF6\u4E2D\u9009\u62E9\u56FE\u50CF",children:(0,n.jsx)(I.Z,{style:{position:"absolute",top:(d=u.top)!==null&&d!==void 0?d:6,right:(t=u.right)!==null&&t!==void 0?t:12},onClick:function(){R(u)}})})]})},D=g},44067:function(W,Z,e){e.r(Z),e.d(Z,{default:function(){return X},findById:function(){return G}});var I=e(13012),o=e.n(I),C=e(17061),l=e.n(C),m=e(42122),$=e.n(m),v=e(17156),T=e.n(v),j=e(25874),U=e(14698);function M(R){var g=/^(https?):\/\/[-A-Za-z0-9+&@#\/%?=~_|!:,.;]*[-A-Za-z0-9+&@#\/%=~_|]$/;return g.test(R)}var i=e(90930),p=e(97269),E=e(64317),n=e(5966),V=e(90672),A=e(63434),b=e(40742),z=e(4393),N=e(67294),H=e(88580),w=e(89048),f=e(85893);function J(){return B.apply(this,arguments)}function B(){return B=T()(l()().mark(function R(){return l()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,b.request)("/api/project/all",{method:"GET"}));case 1:case"end":return D.stop()}},R)})),B.apply(this,arguments)}function G(R){return L.apply(this,arguments)}function L(){return L=T()(l()().mark(function R(g){return l()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,b.request)("/api/admin/version/get",{method:"GET",params:{id:g}}));case 1:case"end":return h.stop()}},R)})),L.apply(this,arguments)}var Q=function(){var g=(0,N.useRef)(),D=(0,H.Z)("id"),h=function(){var t=T()(l()().mark(function c(s){var r;return l()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return console.log(s),y.next=3,(0,U.qx)($()($()({},s),{},{project:{id:s.projectId}}));case 3:return r=y.sent,y.abrupt("return",r.success);case 5:case"end":return y.stop()}},c)}));return function(s){return t.apply(this,arguments)}}();function u(){return d.apply(this,arguments)}function d(){return d=T()(l()().mark(function t(){var c,s,r,a,y,F,O,S,K;return l()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!D){x.next=8;break}return c=parseInt(D),x.next=4,G(c);case 4:s=x.sent,r=s.success,a=s.data,r&&((y=g.current)===null||y===void 0||y.setFieldsValue(a),(F=g.current)===null||F===void 0||F.setFieldValue("projectId",(O=a.project)===null||O===void 0?void 0:O.id),(S=g.current)===null||S===void 0||S.setFieldValue("enable",(K=a.enable)!==null&&K!==void 0?K:!1));case 8:case"end":return x.stop()}},t)})),d.apply(this,arguments)}return(0,w.Z)(function(){D&&u()}),(0,f.jsx)(i._z,{title:"\u53D1\u5E03\u65B0\u7248\u672C",children:(0,f.jsx)(z.Z,{children:(0,f.jsxs)(p.A,{onFinish:h,formRef:g,children:[(0,f.jsx)(E.Z,{label:"\u5173\u8054\u9879\u76EE",name:"projectId",request:T()(l()().mark(function t(){var c;return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,J();case 2:return c=r.sent,r.abrupt("return",c.data.map(function(a){return{label:a.name,value:a.id}}));case 4:case"end":return r.stop()}},t)})),required:!0}),(0,f.jsx)(n.Z,{name:"id",label:"\u4E3B\u952E",hidden:!0}),(0,f.jsx)(n.Z,{name:"title",label:"\u6807\u9898"}),(0,f.jsx)(V.Z,{name:"description",label:"\u66F4\u65B0\u8BB0\u5F55",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u66F4\u65B0\u8BB0\u5F55"}]}),(0,f.jsx)(j.Z,{onFileSelect:function(c){var s,r,a;(s=g.current)===null||s===void 0||s.setFieldValue("downloadUrl",c.url),(r=g.current)===null||r===void 0||r.setFieldValue("packageSize",c.fileSize),(a=g.current)===null||a===void 0||a.setFieldValue("isDirectLink",!0)},children:(0,f.jsx)(V.Z,{fieldProps:{rows:5},name:"downloadUrl",label:"\u4E0B\u8F7D\u5730\u5740(\u76F4\u94FE)",rules:[function(t){return o()(t),{validator:function(s,r,a){r&&r.trim().length>0&&!M(r)?a("\u8BF7\u8F93\u5165\u6709\u6548\u7684\u4E0B\u8F7D\u5730\u5740"):a(void 0)}}}]})}),(0,f.jsx)(E.Z,{name:"platform",label:"\u5E73\u53F0",required:!0,options:[{label:"\u82F9\u679C",value:"Ios"},{label:"\u5B89\u5353",value:"Android"},{label:"Windows",value:"Windows"},{label:"Macos",value:"Macos"},{label:"Linux",value:"Linux"}]}),(0,f.jsx)(V.Z,{help:"\u591A\u4E2A\u8BF7\u6362\u884C",name:"htmlViewPage",label:"\u7B2C\u4E09\u65B9\u4E0B\u8F7D\u5730\u5740",rules:[function(t){return o()(t),{validator:function(s,r,a){r&&r.trim().length>0&&!M(r)?a("\u8BF7\u8F93\u5165\u6709\u6548\u7684\u4E0B\u8F7D\u5730\u5740"):a(void 0)}}}]}),(0,f.jsx)(n.Z,{name:"packageSize",label:"\u5305\u5927\u5C0F"}),(0,f.jsx)(A.Z,{name:"enable",label:"\u662F\u5426\u6709\u6548"}),(0,f.jsx)(A.Z,{name:"disabled",label:"\u662F\u5426\u6709\u6548",hidden:!0,initialValue:!0}),(0,f.jsx)(n.Z,{name:"versionNumber",label:"\u7248\u672C\u53F7",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7248\u672C\u53F7"}]})]})})})},X=Q},9096:function(W,Z,e){e.d(Z,{QU:function(){return U},Zq:function(){return T},oC:function(){return $}});var I=e(17061),o=e.n(I),C=e(17156),l=e.n(C),m=e(40742);function $(i){return v.apply(this,arguments)}function v(){return v=l()(o()().mark(function i(p){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/file/list",{params:p}));case 1:case"end":return n.stop()}},i)})),v.apply(this,arguments)}function T(i){return j.apply(this,arguments)}function j(){return j=l()(o()().mark(function i(p){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/storage/delete",{method:"DELETE",params:{id:p}}));case 1:case"end":return n.stop()}},i)})),j.apply(this,arguments)}function U(i){return M.apply(this,arguments)}function M(){return M=l()(o()().mark(function i(p){var E,n;return o()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return E=new FormData,E.append("file",p),A.next=4,(0,m.request)("/api/auth/simple-upload",{method:"POST",data:E});case 4:return n=A.sent,A.abrupt("return",n.data);case 6:case"end":return A.stop()}},i)})),M.apply(this,arguments)}},14698:function(W,Z,e){e.d(Z,{I9:function(){return U},qx:function(){return T}});var I=e(17061),o=e.n(I),C=e(17156),l=e.n(C),m=e(40742);function $(i){return v.apply(this,arguments)}function v(){return v=_asyncToGenerator(_regeneratorRuntime().mark(function i(p){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/version/list",{method:"GET",params:p}));case 1:case"end":return n.stop()}},i)})),v.apply(this,arguments)}function T(i){return j.apply(this,arguments)}function j(){return j=l()(o()().mark(function i(p){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/admin/version/save",{method:"POST",data:p}));case 1:case"end":return n.stop()}},i)})),j.apply(this,arguments)}function U(i){return M.apply(this,arguments)}function M(){return M=l()(o()().mark(function i(p){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/admin/version/delete",{method:"DELETE",params:{id:p}}));case 1:case"end":return n.stop()}},i)})),M.apply(this,arguments)}},10981:function(W,Z,e){e.d(Z,{P:function(){return o},V:function(){return C}});var I=e(92273);function o(){var l,m=(l=(0,I.rS)())!==null&&l!==void 0?l:"";return m!==""?{Authorization:m}:{}}function C(){return{"Content-Type":"multipart/form-data"}}}}]);
