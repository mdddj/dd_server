"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[14],{46036:function(B,b,e){e.d(b,{Z:function(){return D}});var O=e(88736),o=e(66594),C=e(93236),l=e(26068),m=e.n(l),Z=e(90228),v=e.n(Z),T=e(87999),j=e.n(T),$=e(48305),M=e.n($),i=e(67825),p=e.n(i),E=e(92628),n=e(62086),U=function(u){return _jsx(Modal,_objectSpread({},u))};function A(h,u){var d=document.createElement("div");d.id="select-file";var t=(0,E.createRoot)(d),c=!0,s=C.cloneElement(h,m()(m()({open:c,getContainer:!1,onCancel:function(){var a=C.cloneElement(s,{open:!1});t.render(a),console.log("\u5173\u95ED"),setTimeout(function(){t.unmount(),d.remove()},300)}},u),{},{onFileSelect:function(a){u==null||u.onFileSelect(a);var y=C.cloneElement(s,{open:!1});t.render(y),setTimeout(function(){t.unmount(),d.remove()},300)}}));t.render(s),document.body.appendChild(d)}var K=e(88108),G=e(94101),z=e(9971),N=e(32835),H=e(26003),f=e(99426),J=e(94975),x=e(56701),W=e(9117),V=["onFileSelect"],w=function(u){var d=u.file,t=u.onClick;return(0,n.jsx)(H.J,{onClick:t,isZoomed:!0,alt:d.fileName,src:d.url,className:"object-contain w-full aspect-square bg-secondary-50"})},Q=function(u){var d=u.onFileSelect,t=p()(u,V),c=(0,C.useState)([]),s=M()(c,2),r=s[0],a=s[1],y=function(){var F=j()(v()().mark(function _(){var S;return v()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,(0,K.oC)({current:1,pageSize:20,remove:1});case 2:S=P.sent,a(S.data.list);case 4:case"end":return P.stop()}},_)}));return function(){return F.apply(this,arguments)}}();return(0,W.Z)(j()(v()().mark(function F(){return v()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,y();case 2:case"end":return S.stop()}},F)}))),(0,n.jsxs)(f.Z,m()(m()({title:"\u9009\u62E9\u6587\u4EF6"},t),{},{children:[(0,n.jsx)("div",{style:{marginBottom:12},children:(0,n.jsx)(J.Z,{name:"file",action:z.t+"/api/storage/upload",headers:(0,N.P)(),onChange:function(){var F=j()(v()().mark(function _(S){return v()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(S.file.status!=="done"){P.next=3;break}return P.next=3,y();case 3:case"end":return P.stop()}},_)}));return function(_){return F.apply(this,arguments)}}(),children:(0,n.jsx)(x.ZP,{type:"primary",icon:(0,n.jsx)(G.Z,{}),children:"\u65B0."})})}),(0,n.jsx)("div",{className:"grid grid-cols-4 gap-2",children:r.map(function(F){return(0,n.jsx)(w,{file:F,onClick:function(){return d(F)}},F.id)})})]}))};function I(h){A((0,n.jsx)(Q,m()({},h)),h)}var g=function(u){var d,t;return(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("div",{style:{flex:1,marginRight:2},children:u.children}),(0,n.jsx)(o.Z,{title:"\u4ECE\u6587\u4EF6\u4E2D\u9009\u62E9\u56FE\u50CF",children:(0,n.jsx)(O.Z,{style:{position:"absolute",top:(d=u.top)!==null&&d!==void 0?d:6,right:(t=u.right)!==null&&t!==void 0?t:12},onClick:function(){I(u)}})})]})},D=g},15374:function(B,b,e){e.r(b),e.d(b,{default:function(){return Q},findById:function(){return W}});var O=e(36075),o=e.n(O),C=e(90228),l=e.n(C),m=e(26068),Z=e.n(m),v=e(87999),T=e.n(v),j=e(46036),$=e(51570);function M(I){var g=/^(https?):\/\/[-A-Za-z0-9+&@#\/%?=~_|!:,.;]*[-A-Za-z0-9+&@#\/%=~_|]$/;return g.test(I)}var i=e(24454),p=e(89577),E=e(41642),n=e(65215),U=e(33441),A=e(23886),K=e(88129),G=e(42573),z=e(93236),N=e(53976),H=e(9117),f=e(62086);function J(){return x.apply(this,arguments)}function x(){return x=T()(l()().mark(function I(){return l()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,K.request)("/api/project/all",{method:"GET"}));case 1:case"end":return D.stop()}},I)})),x.apply(this,arguments)}function W(I){return V.apply(this,arguments)}function V(){return V=T()(l()().mark(function I(g){return l()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,K.request)("/api/admin/version/get",{method:"GET",params:{id:g}}));case 1:case"end":return h.stop()}},I)})),V.apply(this,arguments)}var w=function(){var g=(0,z.useRef)(),D=(0,N.Z)("id"),h=function(){var t=T()(l()().mark(function c(s){var r;return l()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return console.log(s),y.next=3,(0,$.qx)(Z()(Z()({},s),{},{project:{id:s.projectId}}));case 3:return r=y.sent,y.abrupt("return",r.success);case 5:case"end":return y.stop()}},c)}));return function(s){return t.apply(this,arguments)}}();function u(){return d.apply(this,arguments)}function d(){return d=T()(l()().mark(function t(){var c,s,r,a,y,F,_,S,L;return l()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(!D){R.next=8;break}return c=parseInt(D),R.next=4,W(c);case 4:s=R.sent,r=s.success,a=s.data,r&&((y=g.current)===null||y===void 0||y.setFieldsValue(a),(F=g.current)===null||F===void 0||F.setFieldValue("projectId",(_=a.project)===null||_===void 0?void 0:_.id),(S=g.current)===null||S===void 0||S.setFieldValue("enable",(L=a.enable)!==null&&L!==void 0?L:!1));case 8:case"end":return R.stop()}},t)})),d.apply(this,arguments)}return(0,H.Z)(function(){D&&u()}),(0,f.jsx)(i._z,{title:"\u53D1\u5E03\u65B0\u7248\u672C",children:(0,f.jsx)(G.Z,{children:(0,f.jsxs)(p.A,{onFinish:h,formRef:g,children:[(0,f.jsx)(E.Z,{label:"\u5173\u8054\u9879\u76EE",name:"projectId",request:T()(l()().mark(function t(){var c;return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,J();case 2:return c=r.sent,r.abrupt("return",c.data.map(function(a){return{label:a.name,value:a.id}}));case 4:case"end":return r.stop()}},t)})),required:!0}),(0,f.jsx)(n.Z,{name:"id",label:"\u4E3B\u952E",hidden:!0}),(0,f.jsx)(n.Z,{name:"title",label:"\u6807\u9898"}),(0,f.jsx)(U.Z,{name:"description",label:"\u66F4\u65B0\u8BB0\u5F55",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u66F4\u65B0\u8BB0\u5F55"}]}),(0,f.jsx)(j.Z,{onFileSelect:function(c){var s,r,a;(s=g.current)===null||s===void 0||s.setFieldValue("downloadUrl",c.url),(r=g.current)===null||r===void 0||r.setFieldValue("packageSize",c.fileSize),(a=g.current)===null||a===void 0||a.setFieldValue("isDirectLink",!0)},children:(0,f.jsx)(U.Z,{fieldProps:{rows:5},name:"downloadUrl",label:"\u4E0B\u8F7D\u5730\u5740(\u76F4\u94FE)",rules:[function(t){return o()(t),{validator:function(s,r,a){r&&r.trim().length>0&&!M(r)?a("\u8BF7\u8F93\u5165\u6709\u6548\u7684\u4E0B\u8F7D\u5730\u5740"):a(void 0)}}}]})}),(0,f.jsx)(E.Z,{name:"platform",label:"\u5E73\u53F0",required:!0,options:[{label:"\u82F9\u679C",value:"Ios"},{label:"\u5B89\u5353",value:"Android"},{label:"Windows",value:"Windows"},{label:"Macos",value:"Macos"},{label:"Linux",value:"Linux"}]}),(0,f.jsx)(U.Z,{help:"\u591A\u4E2A\u8BF7\u6362\u884C",name:"htmlViewPage",label:"\u7B2C\u4E09\u65B9\u4E0B\u8F7D\u5730\u5740",rules:[function(t){return o()(t),{validator:function(s,r,a){r&&r.trim().length>0&&!M(r)?a("\u8BF7\u8F93\u5165\u6709\u6548\u7684\u4E0B\u8F7D\u5730\u5740"):a(void 0)}}}]}),(0,f.jsx)(n.Z,{name:"packageSize",label:"\u5305\u5927\u5C0F"}),(0,f.jsx)(A.Z,{name:"enable",label:"\u662F\u5426\u6709\u6548"}),(0,f.jsx)(A.Z,{name:"disabled",label:"\u662F\u5426\u6709\u6548",hidden:!0,initialValue:!0}),(0,f.jsx)(n.Z,{name:"versionNumber",label:"\u7248\u672C\u53F7",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7248\u672C\u53F7"}]})]})})})},Q=w},88108:function(B,b,e){e.d(b,{QU:function(){return $},Zq:function(){return T},oC:function(){return Z}});var O=e(90228),o=e.n(O),C=e(87999),l=e.n(C),m=e(88129);function Z(i){return v.apply(this,arguments)}function v(){return v=l()(o()().mark(function i(p){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/file/list",{params:p}));case 1:case"end":return n.stop()}},i)})),v.apply(this,arguments)}function T(i){return j.apply(this,arguments)}function j(){return j=l()(o()().mark(function i(p){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/storage/delete",{method:"DELETE",params:{id:p}}));case 1:case"end":return n.stop()}},i)})),j.apply(this,arguments)}function $(i){return M.apply(this,arguments)}function M(){return M=l()(o()().mark(function i(p){var E,n;return o()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return E=new FormData,E.append("file",p),A.next=4,(0,m.request)("/api/auth/simple-upload",{method:"POST",data:E});case 4:return n=A.sent,A.abrupt("return",n.data);case 6:case"end":return A.stop()}},i)})),M.apply(this,arguments)}},51570:function(B,b,e){e.d(b,{I9:function(){return $},qx:function(){return T}});var O=e(90228),o=e.n(O),C=e(87999),l=e.n(C),m=e(88129);function Z(i){return v.apply(this,arguments)}function v(){return v=_asyncToGenerator(_regeneratorRuntime().mark(function i(p){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/version/list",{method:"GET",params:p}));case 1:case"end":return n.stop()}},i)})),v.apply(this,arguments)}function T(i){return j.apply(this,arguments)}function j(){return j=l()(o()().mark(function i(p){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/admin/version/save",{method:"POST",data:p}));case 1:case"end":return n.stop()}},i)})),j.apply(this,arguments)}function $(i){return M.apply(this,arguments)}function M(){return M=l()(o()().mark(function i(p){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,m.request)("/api/admin/version/delete",{method:"DELETE",params:{id:p}}));case 1:case"end":return n.stop()}},i)})),M.apply(this,arguments)}},32835:function(B,b,e){e.d(b,{P:function(){return o},V:function(){return C}});var O=e(63940);function o(){var l,m=(l=(0,O.rS)())!==null&&l!==void 0?l:"";return m!==""?{Authorization:m}:{}}function C(){return{"Content-Type":"multipart/form-data"}}}}]);
