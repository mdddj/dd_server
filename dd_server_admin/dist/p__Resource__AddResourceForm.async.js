"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8246],{25874:function(k,S,e){e.d(S,{Z:function(){return X}});var x=e(25465),s=e(83062),D=e(67294),u=e(42122),m=e.n(u),j=e(17061),y=e.n(j),R=e(17156),A=e.n(R),U=e(27424),L=e.n(U),o=e(70215),T=e.n(o),v=e(20745),r=e(85893),B=function(c){return _jsx(Modal,_objectSpread({},c))};function g(Z,c){var l=document.createElement("div");l.id="select-file";var n=(0,v.createRoot)(l),h=!0,d=D.cloneElement(Z,m()(m()({open:h,getContainer:!1,onCancel:function(){var P=D.cloneElement(d,{open:!1});n.render(P),console.log("\u5173\u95ED"),setTimeout(function(){n.unmount(),l.remove()},300)}},c),{},{onFileSelect:function(P){c==null||c.onFileSelect(P);var O=D.cloneElement(d,{open:!1});n.render(O),setTimeout(function(){n.unmount(),l.remove()},300)}}));n.render(d),document.body.appendChild(l)}var K=e(9096),b=e(88484),W=e(55375),a=e(10981),p=e(44033),f=e(85576),t=e(85303),q=e(28036),J=e(89048),z=["onFileSelect"],V=function(c){var l=c.file,n=c.onClick;return(0,r.jsx)(p.J,{onClick:n,isZoomed:!0,alt:l.fileName,src:l.url,className:"object-contain w-full aspect-square bg-secondary-50"})},E=function(c){var l=c.onFileSelect,n=T()(c,z),h=(0,D.useState)([]),d=L()(h,2),M=d[0],P=d[1],O=function(){var C=A()(y()().mark(function $(){var I;return y()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,(0,K.oC)({current:1,pageSize:20,remove:1});case 2:I=F.sent,P(I.data.list);case 4:case"end":return F.stop()}},$)}));return function(){return C.apply(this,arguments)}}();return(0,J.Z)(A()(y()().mark(function C(){return y()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,O();case 2:case"end":return I.stop()}},C)}))),(0,r.jsxs)(f.Z,m()(m()({title:"\u9009\u62E9\u6587\u4EF6"},n),{},{children:[(0,r.jsx)("div",{style:{marginBottom:12},children:(0,r.jsx)(t.Z,{name:"file",action:W.ty+"/api/storage/upload",headers:(0,a.P)(),onChange:function(){var C=A()(y()().mark(function $(I){return y()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(I.file.status!=="done"){F.next=3;break}return F.next=3,O();case 3:case"end":return F.stop()}},$)}));return function($){return C.apply(this,arguments)}}(),children:(0,r.jsx)(q.ZP,{type:"primary",icon:(0,r.jsx)(b.Z,{}),children:"\u65B0."})})}),(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2",children:M.map(function(C){return(0,r.jsx)(V,{file:C,onClick:function(){return l(C)}},C.id)})})]}))};function Q(Z){g((0,r.jsx)(E,m()({},Z)),Z)}var ee=function(c){var l,n;return(0,r.jsxs)("div",{style:{position:"relative"},children:[(0,r.jsx)("div",{style:{flex:1,marginRight:2},children:c.children}),(0,r.jsx)(s.Z,{title:"\u4ECE\u6587\u4EF6\u4E2D\u9009\u62E9\u56FE\u50CF",children:(0,r.jsx)(x.Z,{style:{position:"absolute",top:(l=c.top)!==null&&l!==void 0?l:6,right:(n=c.right)!==null&&n!==void 0?n:12},onClick:function(){Q(c)}})})]})},X=ee},51625:function(k,S,e){var x=e(17061),s=e.n(x),D=e(42122),u=e.n(D),m=e(861),j=e.n(m),y=e(27424),R=e.n(y),A=e(17156),U=e.n(A),L=e(64317),o=e(40742),T=e(65233),v=e(67294),r=e(85893);function B(){return g.apply(this,arguments)}function g(){return g=U()(s()().mark(function b(){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,o.request)("/api/rc/types"));case 1:case"end":return a.stop()}},b)})),g.apply(this,arguments)}var K=function(W){var a,p=(0,v.useState)(""),f=R()(p,2),t=f[0],q=f[1],J=(0,o.useRequest)(function(){return B()}),z=J.data,V=J.loading;return(0,r.jsx)(L.Z,u()(u()({},W),{},{options:[].concat(j()((a=z==null?void 0:z.map(function(E){return{label:E.type,value:E.type}}))!==null&&a!==void 0?a:[]),[t!==""&&{label:t,value:t}]),fieldProps:{loading:V,dropdownRender:function(Q){return(0,r.jsxs)(r.Fragment,{children:[Q,(0,r.jsx)(T.Z,{onChange:function(X){return q(X.target.value)}})]})}}}))};S.Z=K},18812:function(k,S,e){e.r(S),e.d(S,{default:function(){return c}});var x=e(861),s=e.n(x),D=e(17061),u=e.n(D),m=e(17156),j=e.n(m),y=e(27424),R=e.n(y),A=e(42122),U=e.n(A),L=e(4499),o=e(90672),T=e(82014),v=e(67294),r=e(85893),B=function(n){var h=(0,v.useState)(!1),d=R()(h,2),M=d[0],P=d[1],O=function(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(T.Z,{checked:M,onChange:P,size:"small"})," Markdown\u7F16\u8F91\u5668"]})};return(0,r.jsxs)(r.Fragment,{children:[M&&(0,r.jsx)(L.Z,U()({label:n.label,name:n.name,extra:O()},n)),!M&&(0,r.jsx)(o.Z,U()({initialValue:n.value,name:n.name,label:n.label,fieldProps:{rows:8},extra:O()},n))]})},g=B,K=e(25874),b=e(88560),W=e(64317),a=e(40742),p=function(n){var h=n.render,d=(0,a.useRequest)(function(){return(0,b.xi)()}),M=d.data,P=d.loading,O=d.error;return(0,r.jsx)(r.Fragment,{children:h(M!=null?M:[],P,O)})},f=function(n){var h=n.name,d=n.label;return(0,r.jsx)(p,{render:function(P,O){return(0,r.jsx)(W.Z,{width:"md",name:h,label:d,fieldProps:{loading:O},options:s()(P.map(function(C){return{label:C.name,value:C.id}}))})}})},t=e(51625);function q(l){return l.trim()}var J=function(n){var h=new FormData;for(var d in n)n.hasOwnProperty(d)&&h.append(d,n[d]);return h},z=e(90930),V=e(97269),E=e(5966),Q=e(50335),ee=e(1677),X=e(45360),Z=e(4393);function c(){var l,n,h=(0,v.useRef)(),d=(0,v.useState)(),M=R()(d,2),P=M[0],O=M[1],C=(0,a.useSearchParams)(),$=R()(C,1),I=$[0],Y=I.get("update"),F=function(){console.log(Y),(0,b.TZ)(Y).then(function(H){console.log(H);var i=H.data,_=h.current;if(i&&_){var G;_.setFieldValue("title",i.title),_.setFieldValue("content",i.content),_.setFieldValue("categoryId",(G=i.category)===null||G===void 0?void 0:G.id),_.setFieldValue("description",i.description),_.setFieldValue("createDate",i.createDate),_.setFieldValue("updateDate",i.updateDate),_.setFieldValue("label",i.label),_.setFieldValue("thumbnailImage",i.thumbnailImage),_.setFieldValue("links",i.links),_.setFieldValue("type",i.type),_.setFieldValue("authority",i.authority),_.setFieldValue("clickCount",i.clickCount),_.setFieldValue("browserUrl",i.browserUrl),O(i)}})};(0,v.useEffect)(function(){Y&&F()},[Y]);var le=function(){var N=j()(u()().mark(function H(i){var _,G,te,re,ne,se,ae;return u()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(_=X.ZP.loading("\u8BF7\u7A0D\u7B49"),G=i.pictures,te=J(i),G&&G!==void 0)for(re=0,ne=G;re<ne.length;re++)se=ne[re],te.append("pictures",se.originFileObj);return w.next=6,(0,b.h0)(te);case 6:return ae=w.sent,_(),X.ZP.info(ae.message),w.abrupt("return",ae.success);case 10:case"end":return w.stop()}},H)}));return function(i){return N.apply(this,arguments)}}();return(0,r.jsx)(z._z,{title:"\u6DFB\u52A0\u52A8\u6001",children:(0,r.jsx)(Z.Z,{children:(0,r.jsxs)(V.A,{onFinish:le,initialValues:{clickCount:0},formRef:h,children:[(0,r.jsx)(E.Z,{name:"id",label:"\u4E3B\u952E",hidden:!0}),(0,r.jsxs)(V.A.Group,{children:[(0,r.jsx)(f,{name:"categoryId",label:"\u5206\u7C7B"}),(0,r.jsx)(E.Z,{name:"title",label:"\u6807\u9898",width:"lg"})]}),(0,r.jsx)(E.Z,{name:"description",label:"\u63CF\u8FF0"}),(0,r.jsx)(g,{name:"content",label:"\u6B63\u6587\u5185\u5BB9",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6B63\u6587\u5185\u5BB9"}]}),(0,r.jsxs)(V.A.Group,{children:[(0,r.jsx)(Q.Z,{name:"createDate",label:"\u53D1\u5E03\u65F6\u95F4"}),(0,r.jsx)(Q.Z,{name:"updateDate",label:"\u4FEE\u6539\u65F6\u95F4"})]}),(0,r.jsxs)(V.A.Group,{children:[(0,r.jsx)(E.Z,{name:"label",label:"\u6807\u7B7E"}),(0,r.jsx)(K.Z,{onFileSelect:function(H){var i;(i=h.current)===null||i===void 0||i.setFieldValue("thumbnailImage",H.url)},children:(0,r.jsx)(E.Z,{name:"thumbnailImage",label:"\u7F29\u7565\u56FE",rules:[{type:"url",message:"\u8BF7\u8F93\u5165URL"}]})}),(0,r.jsx)(E.Z,{name:"links",label:"\u94FE\u63A5",rules:[{type:"url",message:"\u8BF7\u8F93\u5165URL"}]}),(0,r.jsx)(t.Z,{name:"type",label:"\u7C7B\u578B"})]}),(0,r.jsxs)(V.A.Group,{children:[(0,r.jsx)(E.Z,{name:"authority",label:"\u6743\u9650",rules:[{type:"number",message:"\u8BF7\u8F93\u5165\u6570\u5B57"}]}),(0,r.jsx)(E.Z,{name:"clickCount",label:"\u70B9\u51FB\u91CF",rules:[{type:"number",message:"\u8BF7\u8F93\u5165\u6570\u5B57"}]}),(0,r.jsx)(E.Z,{name:"mianji",label:"\u9762\u57FA\u4E13\u7528"}),(0,r.jsx)(E.Z,{name:"browserUrl",label:"url",rules:[{type:"url",message:"\u8BF7\u8F93\u5165URL"}]})]}),(0,r.jsx)(ee.Z,{name:"pictures",label:"\u56FE\u7247",max:9,fieldProps:{name:"pictures",listType:"picture-card",multiple:!0,defaultFileList:s()((l=P==null||(n=P.images)===null||n===void 0?void 0:n.map(function(N){return{uid:"".concat(N.id),url:N.url,name:N.fileName}}))!==null&&l!==void 0?l:[])}})]})})})}},9096:function(k,S,e){e.d(S,{QU:function(){return U},Zq:function(){return R},oC:function(){return j}});var x=e(17061),s=e.n(x),D=e(17156),u=e.n(D),m=e(40742);function j(o){return y.apply(this,arguments)}function y(){return y=u()(s()().mark(function o(T){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,m.request)("/api/file/list",{params:T}));case 1:case"end":return r.stop()}},o)})),y.apply(this,arguments)}function R(o){return A.apply(this,arguments)}function A(){return A=u()(s()().mark(function o(T){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,m.request)("/api/storage/delete",{method:"DELETE",params:{id:T}}));case 1:case"end":return r.stop()}},o)})),A.apply(this,arguments)}function U(o){return L.apply(this,arguments)}function L(){return L=u()(s()().mark(function o(T){var v,r;return s()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return v=new FormData,v.append("file",T),g.next=4,(0,m.request)("/api/auth/simple-upload",{method:"POST",data:v});case 4:return r=g.sent,g.abrupt("return",r.data);case 6:case"end":return g.stop()}},o)})),L.apply(this,arguments)}},88560:function(k,S,e){e.d(S,{Ip:function(){return y},Lq:function(){return g},Mg:function(){return L},TQ:function(){return T},TZ:function(){return b},h0:function(){return r},xi:function(){return A}});var x=e(17061),s=e.n(x),D=e(17156),u=e.n(D),m=e(10981),j=e(40742);function y(a){return R.apply(this,arguments)}function R(){return R=u()(s()().mark(function a(p){return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,j.request)("/api/res/list",{method:"GET",params:p}));case 1:case"end":return t.stop()}},a)})),R.apply(this,arguments)}function A(){return U.apply(this,arguments)}function U(){return U=u()(s()().mark(function a(){return s()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,j.request)("/api/res/all",{method:"GET"}));case 1:case"end":return f.stop()}},a)})),U.apply(this,arguments)}function L(a){return o.apply(this,arguments)}function o(){return o=u()(s()().mark(function a(p){return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,j.request)("/api/auth/res-cate-save",{method:"POST",data:p}));case 1:case"end":return t.stop()}},a)})),o.apply(this,arguments)}function T(a){return v.apply(this,arguments)}function v(){return v=u()(s()().mark(function a(p){return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,j.request)("/api/resource/list",{method:"GET",params:p}));case 1:case"end":return t.stop()}},a)})),v.apply(this,arguments)}function r(a){return B.apply(this,arguments)}function B(){return B=u()(s()().mark(function a(p){return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,j.request)("/api/resource/add-post",{method:"POST",headers:(0,m.V)(),data:p}));case 1:case"end":return t.stop()}},a)})),B.apply(this,arguments)}function g(a){return K.apply(this,arguments)}function K(){return K=u()(s()().mark(function a(p){return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,j.request)("/api/resource/delete",{method:"DELETE",params:{id:p}}));case 1:case"end":return t.stop()}},a)})),K.apply(this,arguments)}function b(a){return W.apply(this,arguments)}function W(){return W=u()(s()().mark(function a(p){return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,j.request)("/api/app/resource/find-by-id",{params:{id:p}}));case 1:case"end":return t.stop()}},a)})),W.apply(this,arguments)}},10981:function(k,S,e){e.d(S,{P:function(){return s},V:function(){return D}});var x=e(92273);function s(){var u,m=(u=(0,x.rS)())!==null&&u!==void 0?u:"";return m!==""?{Authorization:m}:{}}function D(){return{"Content-Type":"multipart/form-data"}}}}]);
