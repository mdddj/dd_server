"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8246],{46036:function(k,F,e){e.d(F,{Z:function(){return Y}});var S=e(88736),l=e(66594),b=e(93236),u=e(26068),_=e.n(u),j=e(90228),y=e.n(j),D=e(87999),A=e.n(D),U=e(48305),x=e.n(U),o=e(67825),R=e.n(o),c=e(92628),r=e(62086),B=function(m){return _jsx(Modal,_objectSpread({},m))};function g(Z,m){var s=document.createElement("div");s.id="select-file";var t=(0,c.createRoot)(s),f=!0,d=b.cloneElement(Z,_()(_()({open:f,getContainer:!1,onCancel:function(){var P=b.cloneElement(d,{open:!1});t.render(P),console.log("\u5173\u95ED"),setTimeout(function(){t.unmount(),s.remove()},300)}},m),{},{onFileSelect:function(P){m==null||m.onFileSelect(P);var T=b.cloneElement(d,{open:!1});t.render(T),setTimeout(function(){t.unmount(),s.remove()},300)}}));t.render(d),document.body.appendChild(s)}var K=e(88108),L=e(94101),W=e(9971),a=e(32835),p=e(26003),v=e(99426),n=e(94975),q=e(56701),H=e(9117),z=["onFileSelect"],V=function(m){var s=m.file,t=m.onClick;return(0,r.jsx)(p.J,{onClick:t,isZoomed:!0,alt:s.fileName,src:s.url,className:"object-contain w-full aspect-square bg-secondary-50"})},E=function(m){var s=m.onFileSelect,t=R()(m,z),f=(0,b.useState)([]),d=x()(f,2),M=d[0],P=d[1],T=function(){var C=A()(y()().mark(function $(){var I;return y()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(0,K.oC)({current:1,pageSize:20,remove:1});case 2:I=O.sent,P(I.data.list);case 4:case"end":return O.stop()}},$)}));return function(){return C.apply(this,arguments)}}();return(0,H.Z)(A()(y()().mark(function C(){return y()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,T();case 2:case"end":return I.stop()}},C)}))),(0,r.jsxs)(v.Z,_()(_()({title:"\u9009\u62E9\u6587\u4EF6"},t),{},{children:[(0,r.jsx)("div",{style:{marginBottom:12},children:(0,r.jsx)(n.Z,{name:"file",action:W.t+"/api/storage/upload",headers:(0,a.P)(),onChange:function(){var C=A()(y()().mark(function $(I){return y()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(I.file.status!=="done"){O.next=3;break}return O.next=3,T();case 3:case"end":return O.stop()}},$)}));return function($){return C.apply(this,arguments)}}(),children:(0,r.jsx)(q.ZP,{type:"primary",icon:(0,r.jsx)(L.Z,{}),children:"\u65B0."})})}),(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2",children:M.map(function(C){return(0,r.jsx)(V,{file:C,onClick:function(){return s(C)}},C.id)})})]}))};function Q(Z){g((0,r.jsx)(E,_()({},Z)),Z)}var ee=function(m){var s,t;return(0,r.jsxs)("div",{style:{position:"relative"},children:[(0,r.jsx)("div",{style:{flex:1,marginRight:2},children:m.children}),(0,r.jsx)(l.Z,{title:"\u4ECE\u6587\u4EF6\u4E2D\u9009\u62E9\u56FE\u50CF",children:(0,r.jsx)(S.Z,{style:{position:"absolute",top:(s=m.top)!==null&&s!==void 0?s:6,right:(t=m.right)!==null&&t!==void 0?t:12},onClick:function(){Q(m)}})})]})},Y=ee},16062:function(k,F,e){var S=e(90228),l=e.n(S),b=e(26068),u=e.n(b),_=e(15558),j=e.n(_),y=e(48305),D=e.n(y),A=e(87999),U=e.n(A),x=e(41642),o=e(88129),R=e(56889),c=e(93236),r=e(62086);function B(){return g.apply(this,arguments)}function g(){return g=U()(l()().mark(function L(){return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,o.request)("/api/rc/types"));case 1:case"end":return a.stop()}},L)})),g.apply(this,arguments)}var K=function(W){var a,p=(0,c.useState)(""),v=D()(p,2),n=v[0],q=v[1],H=(0,o.useRequest)(function(){return B()}),z=H.data,V=H.loading;return(0,r.jsx)(x.Z,u()(u()({},W),{},{options:[].concat(j()((a=z==null?void 0:z.map(function(E){return{label:E.type,value:E.type}}))!==null&&a!==void 0?a:[]),[n!==""&&{label:n,value:n}]),fieldProps:{loading:V,dropdownRender:function(Q){return(0,r.jsxs)(r.Fragment,{children:[Q,(0,r.jsx)(R.Z,{onChange:function(Y){return q(Y.target.value)}})]})}}}))};F.Z=K},56012:function(k,F,e){e.r(F),e.d(F,{default:function(){return m}});var S=e(15558),l=e.n(S),b=e(90228),u=e.n(b),_=e(87999),j=e.n(_),y=e(48305),D=e.n(y),A=e(26068),U=e.n(A),x=e(29010),o=e(33441),R=e(74417),c=e(93236),r=e(62086),B=function(t){var f=(0,c.useState)(!1),d=D()(f,2),M=d[0],P=d[1],T=function(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(R.Z,{checked:M,onChange:P,size:"small"})," Markdown\u7F16\u8F91\u5668"]})};return(0,r.jsxs)(r.Fragment,{children:[M&&(0,r.jsx)(x.Z,U()({label:t.label,name:t.name,extra:T()},t)),!M&&(0,r.jsx)(o.Z,U()({initialValue:t.value,name:t.name,label:t.label,fieldProps:{rows:8},extra:T()},t))]})},g=B,K=e(46036),L=e(97405),W=e(41642),a=e(88129),p=function(t){var f=t.render,d=(0,a.useRequest)(function(){return(0,L.xi)()}),M=d.data,P=d.loading,T=d.error;return(0,r.jsx)(r.Fragment,{children:f(M!=null?M:[],P,T)})},v=function(t){var f=t.name,d=t.label;return(0,r.jsx)(p,{render:function(P,T){return(0,r.jsx)(W.Z,{width:"md",name:f,label:d,fieldProps:{loading:T},options:l()(P.map(function(C){return{label:C.name,value:C.id}}))})}})},n=e(16062);function q(s){return s.trim()}var H=function(t){var f=new FormData;for(var d in t)t.hasOwnProperty(d)&&f.append(d,t[d]);return f},z=e(24454),V=e(89577),E=e(65215),Q=e(15971),ee=e(23494),Y=e(17537),Z=e(42573);function m(){var s,t,f=(0,c.useRef)(),d=(0,c.useState)(),M=D()(d,2),P=M[0],T=M[1],C=(0,a.useSearchParams)(),$=D()(C,1),I=$[0],X=I.get("update"),O=function(){console.log(X),(0,L.TZ)(X).then(function(J){console.log(J);var i=J.data,h=f.current;if(i&&h){var G;h.setFieldValue("title",i.title),h.setFieldValue("content",i.content),h.setFieldValue("categoryId",(G=i.category)===null||G===void 0?void 0:G.id),h.setFieldValue("description",i.description),h.setFieldValue("createDate",i.createDate),h.setFieldValue("updateDate",i.updateDate),h.setFieldValue("label",i.label),h.setFieldValue("thumbnailImage",i.thumbnailImage),h.setFieldValue("links",i.links),h.setFieldValue("type",i.type),h.setFieldValue("authority",i.authority),h.setFieldValue("clickCount",i.clickCount),h.setFieldValue("browserUrl",i.browserUrl),T(i)}})};(0,c.useEffect)(function(){X&&O()},[X]);var se=function(){var N=j()(u()().mark(function J(i){var h,G,ne,re,te,le,ae;return u()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(h=Y.ZP.loading("\u8BF7\u7A0D\u7B49"),G=i.pictures,ne=H(i),G&&G!==void 0)for(re=0,te=G;re<te.length;re++)le=te[re],ne.append("pictures",le.originFileObj);return w.next=6,(0,L.h0)(ne);case 6:return ae=w.sent,h(),Y.ZP.info(ae.message),w.abrupt("return",ae.success);case 10:case"end":return w.stop()}},J)}));return function(i){return N.apply(this,arguments)}}();return(0,r.jsx)(z._z,{title:"\u6DFB\u52A0\u52A8\u6001",children:(0,r.jsx)(Z.Z,{children:(0,r.jsxs)(V.A,{onFinish:se,initialValues:{clickCount:0},formRef:f,children:[(0,r.jsx)(E.Z,{name:"id",label:"\u4E3B\u952E",hidden:!0}),(0,r.jsxs)(V.A.Group,{children:[(0,r.jsx)(v,{name:"categoryId",label:"\u5206\u7C7B"}),(0,r.jsx)(E.Z,{name:"title",label:"\u6807\u9898",width:"lg"})]}),(0,r.jsx)(E.Z,{name:"description",label:"\u63CF\u8FF0"}),(0,r.jsx)(g,{name:"content",label:"\u6B63\u6587\u5185\u5BB9",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6B63\u6587\u5185\u5BB9"}]}),(0,r.jsxs)(V.A.Group,{children:[(0,r.jsx)(Q.Z,{name:"createDate",label:"\u53D1\u5E03\u65F6\u95F4"}),(0,r.jsx)(Q.Z,{name:"updateDate",label:"\u4FEE\u6539\u65F6\u95F4"})]}),(0,r.jsxs)(V.A.Group,{children:[(0,r.jsx)(E.Z,{name:"label",label:"\u6807\u7B7E"}),(0,r.jsx)(K.Z,{onFileSelect:function(J){var i;(i=f.current)===null||i===void 0||i.setFieldValue("thumbnailImage",J.url)},children:(0,r.jsx)(E.Z,{name:"thumbnailImage",label:"\u7F29\u7565\u56FE",rules:[{type:"url",message:"\u8BF7\u8F93\u5165URL"}]})}),(0,r.jsx)(E.Z,{name:"links",label:"\u94FE\u63A5",rules:[{type:"url",message:"\u8BF7\u8F93\u5165URL"}]}),(0,r.jsx)(n.Z,{name:"type",label:"\u7C7B\u578B"})]}),(0,r.jsxs)(V.A.Group,{children:[(0,r.jsx)(E.Z,{name:"authority",label:"\u6743\u9650",rules:[{type:"number",message:"\u8BF7\u8F93\u5165\u6570\u5B57"}]}),(0,r.jsx)(E.Z,{name:"clickCount",label:"\u70B9\u51FB\u91CF",rules:[{type:"number",message:"\u8BF7\u8F93\u5165\u6570\u5B57"}]}),(0,r.jsx)(E.Z,{name:"mianji",label:"\u9762\u57FA\u4E13\u7528"}),(0,r.jsx)(E.Z,{name:"browserUrl",label:"url",rules:[{type:"url",message:"\u8BF7\u8F93\u5165URL"}]})]}),(0,r.jsx)(ee.Z,{name:"pictures",label:"\u56FE\u7247",max:9,fieldProps:{name:"pictures",listType:"picture-card",multiple:!0,defaultFileList:l()((s=P==null||(t=P.images)===null||t===void 0?void 0:t.map(function(N){return{uid:"".concat(N.id),url:N.url,name:N.fileName}}))!==null&&s!==void 0?s:[])}})]})})})}},88108:function(k,F,e){e.d(F,{QU:function(){return U},Zq:function(){return D},oC:function(){return j}});var S=e(90228),l=e.n(S),b=e(87999),u=e.n(b),_=e(88129);function j(o){return y.apply(this,arguments)}function y(){return y=u()(l()().mark(function o(R){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,_.request)("/api/file/list",{params:R}));case 1:case"end":return r.stop()}},o)})),y.apply(this,arguments)}function D(o){return A.apply(this,arguments)}function A(){return A=u()(l()().mark(function o(R){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,_.request)("/api/storage/delete",{method:"DELETE",params:{id:R}}));case 1:case"end":return r.stop()}},o)})),A.apply(this,arguments)}function U(o){return x.apply(this,arguments)}function x(){return x=u()(l()().mark(function o(R){var c,r;return l()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c=new FormData,c.append("file",R),g.next=4,(0,_.request)("/api/auth/simple-upload",{method:"POST",data:c});case 4:return r=g.sent,g.abrupt("return",r.data);case 6:case"end":return g.stop()}},o)})),x.apply(this,arguments)}},97405:function(k,F,e){e.d(F,{Ip:function(){return y},Lq:function(){return g},Mg:function(){return x},TQ:function(){return R},TZ:function(){return L},h0:function(){return r},xi:function(){return A}});var S=e(90228),l=e.n(S),b=e(87999),u=e.n(b),_=e(32835),j=e(88129);function y(a){return D.apply(this,arguments)}function D(){return D=u()(l()().mark(function a(p){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,j.request)("/api/res/list",{method:"GET",params:p}));case 1:case"end":return n.stop()}},a)})),D.apply(this,arguments)}function A(){return U.apply(this,arguments)}function U(){return U=u()(l()().mark(function a(){return l()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,j.request)("/api/res/all",{method:"GET"}));case 1:case"end":return v.stop()}},a)})),U.apply(this,arguments)}function x(a){return o.apply(this,arguments)}function o(){return o=u()(l()().mark(function a(p){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,j.request)("/api/auth/res-cate-save",{method:"POST",data:p}));case 1:case"end":return n.stop()}},a)})),o.apply(this,arguments)}function R(a){return c.apply(this,arguments)}function c(){return c=u()(l()().mark(function a(p){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,j.request)("/api/resource/list",{method:"GET",params:p}));case 1:case"end":return n.stop()}},a)})),c.apply(this,arguments)}function r(a){return B.apply(this,arguments)}function B(){return B=u()(l()().mark(function a(p){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,j.request)("/api/resource/add-post",{method:"POST",headers:(0,_.V)(),data:p}));case 1:case"end":return n.stop()}},a)})),B.apply(this,arguments)}function g(a){return K.apply(this,arguments)}function K(){return K=u()(l()().mark(function a(p){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,j.request)("/api/resource/delete",{method:"DELETE",params:{id:p}}));case 1:case"end":return n.stop()}},a)})),K.apply(this,arguments)}function L(a){return W.apply(this,arguments)}function W(){return W=u()(l()().mark(function a(p){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,j.request)("/api/app/resource/find-by-id",{params:{id:p}}));case 1:case"end":return n.stop()}},a)})),W.apply(this,arguments)}},32835:function(k,F,e){e.d(F,{P:function(){return l},V:function(){return b}});var S=e(63940);function l(){var u,_=(u=(0,S.rS)())!==null&&u!==void 0?u:"";return _!==""?{Authorization:_}:{}}function b(){return{"Content-Type":"multipart/form-data"}}}}]);
